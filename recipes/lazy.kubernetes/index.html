<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">

        <!-- Enable responsiveness on mobile devices-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

        <title>    Manala Recipes - Lazy - Kubernetes
</title>

                    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700|Sacramento|Inconsolata:400,700' rel='stylesheet' type='text/css'>
            <link rel="stylesheet" href="/manala-recipes/build/app.6e1927d4.css">
        
                    <script src="/manala-recipes/build/runtime.e4df57b3.js" defer></script><script src="/manala-recipes/build/app.4fe7be59.js" defer></script>
            </head>
    <body>

        <header class="header">
            <div class="navbar">
    <div class="container">
        <a href="/manala-recipes/" class="logo">Manala recipes</a>
        <nav>
            <ul>
                <li><a href="https://github.com/manala/manala-recipes">Github</a></li>
                <li>
                    <div class="dropdown">
                        <a class="dropdown-toggle" href="/manala-recipes/">Recipes</a>
                        <div class="dropdown-menu">
                                                            <a class="dropdown-item" href="/manala-recipes/recipes/elao.app.docker">Elao - App - Docker</a>
                                                            <a class="dropdown-item" href="/manala-recipes/recipes/lazy.ansible">Lazy - Ansible</a>
                                                            <a class="dropdown-item" href="/manala-recipes/recipes/lazy.kubernetes">Lazy - Kubernetes</a>
                                                            <a class="dropdown-item" href="/manala-recipes/recipes/lazy.symfony">Lazy - Symfony</a>
                                                    </div>
                    </div>
                </li>
            </ul>
        </nav>
    </div>
</div>

            <div class="container">
                <div class="row">
                    <div class="col-sm-4">
                        <div class="manala">
                            <div class="circle circle-1"></div>
                            <div class="circle circle-2"></div>
                            <div class="circle circle-3"></div>
                            <div class="circle circle-4"></div>
                            <div class="circle circle-5"></div>
                            <div class="circle circle-6"></div>
                            <img src="/manala-recipes/build/images/arms.b7d6de72.svg" class="arms" alt="Manala">
                            <img src="/manala-recipes/build/images/manala.053e7ef8.svg" class="head" alt="Manala">
                        </div>
                    </div>
                    <div class="lead col-sm-8">
                        <p>Recipes for your projects</p>
                    </div>
                </div>
            </div>
        </header>

        <div class="container">
                <h1>Lazy - Kubernetes</h1>

            <ul>
                            <li>
                    <a href="#requirements">Requirements</a>
                                    </li>
                            <li>
                    <a href="#usage">Usage</a>
                                            <ul class="sub-list">
                                                            <li><a href="#shell">Shell</a></li>
                                                            <li><a href="#makefile">Makefile</a></li>
                                                            <li><a href="#kubectl">Kubectl</a></li>
                                                    </ul>
                                    </li>
                    </ul>
    
        <section>
        <header><h2>Migrations</h2></header>
        <article>
            If you're coming from a previous version of the recipe or another recipe, you might be interested reading the following migration guides:

            <ul>
                                <li>
                    <a href="/manala-recipes/migrations/lazy.kubernetes/MIGRATION.2023-02">
                        Makefile variables refactoring - 2023-02
                    </a>
                </li>
                            </ul>
        </article>
    </section>
    
    <section>
        <article>
            <body><h2 id="requirements">Requirements<a href="#requirements" class="anchor"></a></h2>
<ul>
<li><a href="https://manala.github.io/manala/installation/" target="_blank">Manala CLI</a> to update the recipe</li>
<li>Make</li>
<li>Docker Desktop 2.2.0+ or Docker Engine + Docker Compose</li>
</ul>
<h2 id="usage">Usage<a href="#usage" class="anchor"></a></h2>
<h3 id="shell">Shell<a href="#shell" class="anchor"></a></h3>
<p>Open a shell to container</p>
<pre class="code-multiline language-shell"><code class="language-shell" id="6e3c3438c618a6a853510bb4ffe64803"><span class="token function">make</span> <span class="token function">sh</span></code></pre>
<p>Run commands through container shell</p>
<pre class="code-multiline language-shell"><code class="language-shell" id="9ff5ac17a8d20719cbaa478f5c855a72"><span class="token comment"># From file</span>
<span class="token function">make</span> <span class="token function">sh</span> <span class="token operator">&lt;</span> <span class="token function">file</span>
<span class="token comment"># Multilines, using heredoc</span>
<span class="token function">make</span> <span class="token function">sh</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'EOF'
command 1
command 2
...
EOF</span>
<span class="token comment"># Single line</span>
<span class="token function">make</span> <span class="token function">sh</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token builtin class-name">command</span></code></pre>
<p>Specify working dir</p>
<pre class="code-multiline language-shell"><code class="language-shell" id="847088f9201e66940020a657d621efcc"><span class="token function">make</span> <span class="token function">sh</span> <span class="token assign-left variable">DIR</span><span class="token operator">=</span>/etc <span class="token operator">&lt;&lt;&lt;</span> <span class="token builtin class-name">pwd</span>
/etc</code></pre>
<p>Expose a container port 4321 on localhost:1234</p>
<pre class="code-multiline language-shell"><code class="language-shell" id="1b8b4323502c6c21f2ec3acf73d54c0c"><span class="token function">make</span> <span class="token function">sh</span> <span class="token assign-left variable">PORT</span><span class="token operator">=</span><span class="token number">1234</span>:4321
kubectl --namespace <span class="token punctuation">[</span>namespace<span class="token punctuation">]</span> port-forward --address <span class="token number">0.0</span>.0.0 svc/<span class="token punctuation">[</span>service<span class="token punctuation">]</span> <span class="token number">4321</span>:<span class="token punctuation">[</span>port<span class="token punctuation">]</span></code></pre>
<h3 id="makefile">Makefile<a href="#makefile" class="anchor"></a></h3>
<p>One of the first directive of your project's Makefile should be to include manala recipe <code class="code-inline" id="b67911656ef5d18c4ae36cb6741b7965">Makefile</code></p>
<pre class="code-multiline language-makefile"><code class="language-makefile" id="c469751d466f49d3a21f2f56fe8563a0"><span class="token keyword">include</span> .manala/Makefile</code></pre>
<p>Or, if you're not sure manala recipe directory will be present, make it optional. If you do make it optionnal, you'll have to ensure that every parts of you project's Makefile using manala recipe tools could fallback to another solution.</p>
<pre class="code-multiline language-makefile"><code class="language-makefile" id="5be3a1b05c281ba7b7a088f1cb94b04f"><span class="token keyword">-include</span> .manala/Makefile</code></pre>
<p>Note: it's a good practise to have a <code class="code-inline" id="8b80b390d4c0e0872c8f8eb8fb9e3563">.SILENT:</code> as the first line of your project's Makefile. Not only does it globally silence make targets echoing, but it also offers a lowcost debugging system by just commenting it on demand.</p>
<pre class="code-multiline language-makefile"><code class="language-makefile" id="8b80b390d4c0e0872c8f8eb8fb9e3563"><span class="token builtin-target builtin">.SILENT</span><span class="token punctuation">:</span></code></pre>
<pre class="code-multiline language-makefile"><code class="language-makefile" id="527c30e7bc7484706ba5d8ec1036c6a2"><span class="token comment">#.SILENT:</span></code></pre>
<p>A <code class="code-inline" id="110055b10e8e6724c50ae2ad5527cdc6">MANALA_DOCKER</code> variable is available to check whether you're inside the container or not</p>
<pre class="code-multiline language-makefile"><code class="language-makefile" id="67539c0375386bd709bd8179c6f56576"><span class="token target symbol">foo</span><span class="token punctuation">:</span>
<span class="token keyword">ifdef</span> MANALA_DOCKER
    echo Inside container
<span class="token keyword">else</span>
    echo Outside container
<span class="token keyword">endif</span></code></pre>
<p>A <code class="code-inline" id="49b000e0cd2b995cf6aaa36dd7df095a">MANALA_DIR</code> variable is available to get your project's directory <em>inside</em> container</p>
<pre class="code-multiline language-makefile"><code class="language-makefile" id="6306fc29f1ae6df49bae8a0b798b6389"><span class="token target symbol">foo</span><span class="token punctuation">:</span>
    echo Project directory is <span class="token variable">$</span><span class="token punctuation">(</span>MANALA_DIR<span class="token punctuation">)</span></code></pre>
<p>There are three ways to force your project's Makefile target execution inside container:</p>
<ol>
<li>Function <code class="code-inline" id="8aa008494abe6025239b4c6d218e01cb">manala_docker_shell</code></li>
</ol>
<pre class="code-multiline language-makefile"><code class="language-makefile" id="f8863667038e6e0fa38ee0edd19f7a3e"><span class="token target symbol">foo</span><span class="token punctuation">:</span>
    echo Can be run *inside* or *outside* container
    <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> manala_docker_shell, echo Always run *inside* container<span class="token punctuation">)</span></code></pre>
<ol start="2">
<li>Shell substitution with <code class="code-inline" id="2bacb24a22d4bc2341e310a124c7695f">MANALA_DOCKER_SHELL</code></li>
</ol>
<pre class="code-multiline language-makefile"><code class="language-makefile" id="d489a0318aadf26cf071cd7bb0d89249"><span class="token target symbol">foo</span><span class="token punctuation">:</span> SHELL <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span>MANALA_DOCKER_SHELL<span class="token punctuation">)</span>
<span class="token target symbol">foo</span><span class="token punctuation">:</span>
    echo Always run *inside* container

<span class="token comment"># Or, if you're not sure manala recipe "Makefile" will be included</span>
<span class="token target symbol">foo</span><span class="token punctuation">:</span> SHELL <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">or</span> <span class="token variable">$</span><span class="token punctuation">(</span>MANALA_DOCKER_SHELL<span class="token punctuation">)</span>,<span class="token variable">$</span><span class="token punctuation">(</span>SHELL<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token target symbol">foo</span><span class="token punctuation">:</span>
    echo Can be run *inside* or *outside* container, \
        but always *inside* if manala recipe <span class="token string">"Makefile"</span> is included</code></pre>
<ol start="3">
<li>Make substitution with <code class="code-inline" id="f4ede42c2e932a5ed54bc15eb0ee413e">MANALA_DOCKER_MAKE</code></li>
</ol>
<pre class="code-multiline language-makefile"><code class="language-makefile" id="b190ad08706301c4d8a3994a5fd52a56"><span class="token target symbol">foo</span><span class="token punctuation">:</span>
    <span class="token variable">$</span><span class="token punctuation">(</span>MANALA_DOCKER_MAKE<span class="token punctuation">)</span> bar

<span class="token target symbol">bar</span><span class="token punctuation">:</span>
    echo Run *outside* container if called directly \
        or *inside* container if called from <span class="token string">"foo"</span></code></pre>
<p>An automagic target help system is included out-of-the-box. You can list all available documented commands with <code class="code-inline" id="1e44bdd89936c3da837c09c086678c89">make help</code> (or just <code class="code-inline" id="099dafc678df7d266c25f95ccf6cde22">make</code>,  as the help command is the default one)</p>
<pre class="code-multiline language-shell"><code class="language-shell" id="d0db3d1d6377aa1c5f603b9b60f486ab">$ <span class="token function">make</span>

Usage: <span class="token function">make</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span>

Help:
  <span class="token builtin class-name">help</span> This <span class="token builtin class-name">help</span>

System:
  <span class="token function">sh</span>    Open a <span class="token builtin class-name">local</span> system shell
  clean Clean <span class="token builtin class-name">local</span> system</code></pre>
<p>You can add your own documented commands, by adding double dashed comments in your projects's Makefile</p>
<pre class="code-multiline language-makefile"><code class="language-makefile" id="cc0a344e485a200c5ac5eb972b26a1df"><span class="token comment">## This is foo</span>
<span class="token target symbol">foo</span><span class="token punctuation">:</span>
    ...

<span class="token comment">## Bar - Use the "Bar" help section</span>
<span class="token target symbol">bar.baz</span><span class="token punctuation">:</span>
    ...</code></pre>
<pre class="code-multiline language-shell"><code class="language-shell" id="84e090deed76b8cb6d9e9a6ac9cacbe4">$ <span class="token function">make</span>

Usage: <span class="token function">make</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span>

Help:
  <span class="token builtin class-name">help</span> This <span class="token builtin class-name">help</span>

System:
  <span class="token function">sh</span>    Open a <span class="token builtin class-name">local</span> system shell
  clean Clean <span class="token builtin class-name">local</span> system

Commands:
  foo This is foo

Bar:
  bar.baz Use the <span class="token string">"Bar"</span> <span class="token builtin class-name">help</span> section</code></pre>
<h3 id="kubectl">Kubectl<a href="#kubectl" class="anchor"></a></h3>
<p>Alias <code class="code-inline" id="8ce4b16b22b58894aa86c421e8759df3">k</code></p>
<pre class="code-multiline language-shell"><code class="language-shell" id="c268e5f74b8b150ac20c1c624b5517f5">kubectl version
Client Version: <span class="token punctuation">..</span>.
k version
Client Version: <span class="token punctuation">..</span>.</code></pre></body>
        </article>
    </section>

    <time datetime="2025-10-03UTC09:17:47+00:00">Last modified: October 3, 2025 09:17</time>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="row">
                    <div class="col-sm-4 no-pb">
                        <a href="https://manala.io" class="manala"><img src="/manala-recipes/build/images/manala.053e7ef8.svg" width="56" height="56" title="Manala.io" alt="Manala.io"> Manala.io</a>
                    </div>
                    <div class="col-sm-4 no-pb github text-center">
                        <a href="https://github.com/manala/manala-recipes" target="_blank"><img src="/manala-recipes/build/images/github.04ed74f3.svg" width="32" height="32" title="Manala on Github" alt="Manala recipes on Github"></a>
                    </div>
                    <div class="col-sm-4 no-pb elao">
                        Made with love by <a href="https://www.elao.com" target="_blank"><img src="/manala-recipes/build/images/elao.91d6ac3c.svg" width="64" height="23" title="élao" alt="élao"></a>
                        <small>(and <a target="_blank" href="https://www.rix.fr/"><strong>Rix</strong></a> !)</small>
                    </div>
                </div>
            </div>
        </footer>
    </body>
</html>
